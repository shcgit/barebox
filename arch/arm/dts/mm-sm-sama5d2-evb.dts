/* SPDX-License-Identifier: GPL-2.0+ */
/* SPDX-FileCopyrightText: Alexander Shiyan <shc_work@mail.ru> */

/dts-v1/;

#include "mm-sm-sama5d2.dtsi"

/ {
	model = "Mega-Milas Informer SAMA5D2";
	compatible = "milas,informer-sama5d2", "milas,mm-sm-sama5d2",
		     "atmel,sama5d27", "atmel,sama5d2", "atmel,sama5";

	chosen {
		environment-sd {
			compatible = "barebox,environment";
			device-path = &sdmmc1, "partname:0";
			file-path = "barebox.env";
			status = "disabled";
		};

		environment-qspi {
			compatible = "barebox,environment";
			device-path = &flash, "partname:env";
			status = "disabled";
		};
	};

	vcc_1v8_sys: vcc-1v8-sys-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_1v8_sys";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
	};

	vcc_3v3_sys: vcc-3v3-sys-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_3v3_sys";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
	};
};

&flash {
	partitions {
		compatible = "fixed-partitions";
		#address-cells = <1>;
		#size-cells = <1>;

		partition@0 {
			label = "bootstrap";
			reg = <0 0x10000>;
		};

		partition@10000 {
			label = "boot";
			reg = <0x10000 0x60000>;
		};

		partition@70000 {
			label = "env";
			reg = <0x70000 0x40000>;
		};

		partition@b0000 {
			label = "system";
			reg = <0xb0000 0>;
		};
	};
};

&hlcdc {
	hlcdc-display-controller {
		bus-width = <18>;
	};
};

&i2c0 {
	gpio@24 {
		compatible = "ti,tca9534", "nxp,pca9534";
		reg = <0x24>;
		gpio-controller;

		#gpio-cells = <2>;
	};

	codec@a {
		compatible = "fsl,sgtl5000";
		reg =<0xa>;
//		clocks = <&clk24m>;
		micbias-resistor-k-ohms = <2>;
		VDDA-supply = <&vcc_3v3_sys>;
		VDDIO-supply = <&vcc_1v8_sys>;
		VDDD-supply = <&vcc_1v8_sys>;

		#sound-dai-cells = <0>;
	};
};

&sdmmc1 {
	disable-wp;
	status = "okay";
};

&vcc_sd {
	vin-supply = <&vcc_3v3_sys>;
};

&pioA {
	pinctrl_hlcdc: hlcdc-grp {
		pinmux = <PIN_PB13__LCDDAT2>,
			 <PIN_PB14__LCDDAT3>,
			 <PIN_PB15__LCDDAT4>,
			 <PIN_PB16__LCDDAT5>,
			 <PIN_PB17__LCDDAT6>,
			 <PIN_PB18__LCDDAT7>,
			 <PIN_PB21__LCDDAT10>,
			 <PIN_PB22__LCDDAT11>,
			 <PIN_PB23__LCDDAT12>,
			 <PIN_PB24__LCDDAT13>,
			 <PIN_PB25__LCDDAT14>,
			 <PIN_PB26__LCDDAT15>,
			 <PIN_PB29__LCDDAT18>,
			 <PIN_PB30__LCDDAT19>,
			 <PIN_PB31__LCDDAT20>,
			 <PIN_PC0__LCDDAT21>,
			 <PIN_PC1__LCDDAT22>,
			 <PIN_PC2__LCDDAT23>,
			 <PIN_PC4__LCDDISP>,			/* S133 */
			 <PIN_PC5__LCDVSYNC>,
			 <PIN_PC6__LCDHSYNC>,
			 <PIN_PC7__LCDPCK>,
			 <PIN_PC8__LCDDEN>;
		bias-disable;
	};
};
