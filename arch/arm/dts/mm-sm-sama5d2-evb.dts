/* SPDX-License-Identifier: GPL-2.0+ */
/* SPDX-FileCopyrightText: Alexander Shiyan <shc_work@mail.ru> */

/dts-v1/;

#include "mm-sm-sama5d2.dtsi"

/ {
	model = "Mega-Milas Informer SAMA5D2";
	compatible = "milas,informer-sama5d2", "milas,mm-sm-sama5d2",
		     "atmel,sama5d27", "atmel,sama5d2", "atmel,sama5";

	chosen {
		environment-sd {
			compatible = "barebox,environment";
			device-path = &sdmmc1, "partname:0";
			file-path = "barebox.env";
			status = "disabled";
		};

		environment-qspi {
			compatible = "barebox,environment";
			device-path = &flash, "partname:env";
			status = "disabled";
		};
	};

	vcc_1v8_sys: vcc-1v8-sys-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_1v8_sys";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
	};

	vcc_3v3_sys: vcc-3v3-sys-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_3v3_sys";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
	};
};

&flash {
//	partitions {
//		compatible = "fixed-partitions";
		#address-cells = <1>;
		#size-cells = <1>;

		partition@0 {
			label = "bootstrap";
			reg = <0 0x10000>;
		};

		partition@10000 {
			label = "boot";
			reg = <0x10000 0x60000>;
		};

		partition@70000 {
			label = "env";
			reg = <0x70000 0x40000>;
		};

		partition@b0000 {
			label = "system";
			reg = <0xb0000 0>;
		};
//	};
};

&hlcdc {
	status = "okay";

	hlcdc-display-controller {
		bus-width = <18>;

		port@0 {
			//TODO:
		};
	};
};

&i2c0 {
	gpio@24 {
		compatible = "ti,tca9534", "nxp,pca9534";
		reg = <0x24>;
		gpio-controller;

		#gpio-cells = <2>;
	};

	codec@a {
		compatible = "fsl,sgtl5000";
		reg =<0xa>;
//		clocks = <&clk24m>;
		micbias-resistor-k-ohms = <2>;
		VDDA-supply = <&vcc_3v3_sys>;
		VDDIO-supply = <&vcc_1v8_sys>;
		VDDD-supply = <&vcc_1v8_sys>;

		#sound-dai-cells = <0>;
	};
};

&sdmmc1 {
	disable-wp;
	status = "okay";
};

&vcc_sd {
	vin-supply = <&vcc_3v3_sys>;
};

&pioA {
	pinctrl_hlcdc_default: hlcdc-grp-default {
		bits24 {
			pinmux = <PIN_PB11__GPIO>,
				 <PIN_PB12__GPIO>,
				 <PIN_PB19__GPIO>,
				 <PIN_PB20__GPIO>,
				 <PIN_PB27__GPIO>,
				 <PIN_PB28__GPIO>;
			bias-pull-down;
		};
	};
};
